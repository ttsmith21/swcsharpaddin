{
  "permissions": {
    "allow": [
      "Bash(git reset:*)",
      "Bash(dotnet restore:*)",
      "Bash(dotnet build:*)",
      "Bash(dotnet test:*)",
      "Bash(powershell -ExecutionPolicy Bypass -File scripts/sync-csproj.ps1:*)",
      "Bash(powershell:*)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Professional\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" swcsharpaddin.csproj -p:Configuration=Debug -v:minimal -nologo)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: add build infrastructure, tests, and documentation\n\nBuild Infrastructure:\n- scripts/build-and-test.ps1: VS MSBuild build + xUnit tests\n- scripts/sync-csproj.ps1: sync .cs files to old-style csproj\n- scripts/verify-registration.ps1: check add-in COM registration\n\nTesting:\n- src/NM.Core.Tests/: xUnit test project with smoke tests\n- Integration tests that skip gracefully when SW not running\n\nStatic Analysis:\n- .editorconfig: code style rules + analyzer severities\n- Roslynator + NetAnalyzers packages in csproj\n\nDocumentation:\n- CLAUDE.md: comprehensive guide for autonomous operation\n- .claude/skills/sw-api-patterns/: SW API reference patterns\n- VBAâ†’C# conversion guide with gotchas table\n\nFixes:\n- ModelInfo.cs: proper discard pattern \\(var _ â†’ _\\)\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git push:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: port NM.Core domain models and services from broken commit\n\nPort all NM.Core files from bb89a66:\n- DataModel: PartData central DTO\n- Manufacturing: F140/F220/F325 calculators, cost constants, rates, \n  laser speed service, bend models\n- Materials: OptiMaterialService for thickness-based material lookup\n- Models: SwModelInfo pipeline wrapper\n- ProblemParts: ProblemPartManager with category tracking\n- Processing: PartDataPropertyMap for property conversion\n- Tubes: PipeScheduleService, cutting parameters, work center rules,\n  material code generator, round bar validator\n- Validation: ValidationResult and PartValidator\n\nAlso adds 4-arg back-compat overload to ErrorHandler for legacy callers.\n\nBuild passes with 76 warnings \\(mostly obsolete API usage\\).\nTests: 9/9 pass.\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: add ExportManager for CSV/ERP export\n\nAdd NM.Core.Export.ExportManager with:\n- ExportToCsv: Full PartData export with all fields\n- ExportToErp: Minimal tab-delimited ERP routing format\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(for file in BendTableResolver.cs MainRunner.cs SimpleSheetMetalProcessor.cs ExternalStartAdapter.cs ProblemPartInfo.cs ProblemPartTracker.cs StepFileCleanupService.cs)",
      "Bash(do if [ -f \"$file\" ])",
      "Bash(then echo \"EXISTS: $file\")",
      "Bash(else echo \"MISSING: $file\")",
      "Bash(fi:*)",
      "Bash(done)",
      "Bash(git ls-tree:*)",
      "Bash(test:*)",
      "Bash(grep:*)",
      "Bash(while read f)",
      "Bash(do grep -q \"using NM.Core;\" \"$f\")",
      "Bash(echo:*)",
      "Bash(while read branch)",
      "Bash(do git branch -d \"$branch\")",
      "Bash(for branch in CustomProperties Epic-2-Complete Epic9 MasterPlan ProblemParrsClass SimpleSheetmetalConversion SinglePartEpic Tube feat/bomqty-assembly-traversal feat/generic-opti-material feat/next-coverage-improvement feature/gold-standard-baseline-test-development feature/performance-timers feature/timer-performance-optimization feature/tube-audit-resolution feature/tube-diagnostic-selection feature/wrapper-and-smoketests fix/bend-edge-length fix/laser-speed-excel-data fix/raw-weight-and-laser-run fix/structural-classification fix/tube-opti-material modErrorHandler userForm working-baseline)",
      "WebFetch(domain:api.nuget.org)",
      "Bash(cmdkey:*)",
      "Bash(ls \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\tests\"\" | Select-String \"Run_Step \")",
      "Bash(ls \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\tests\"\" | findstr \"Run_Step \")",
      "Bash(ls:*)",
      "Bash(git log:*)",
      "Bash(dir:*)",
      "Bash(taskkill:*)",
      "Bash(tasklist:*)",
      "Bash(git status:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfix: post-Pass-2 problem wizard, sheet metal cleanup, and purchased part heuristics\n\nThree fixes from manual testing of the 6-hours.step assembly:\n\n1. WorkflowDispatcher: Show problem wizard after Pass 2 processing failures.\n   Previously only shown after Pass 1 validation - 22 failed parts were\n   never presented for user review.\n\n2. SimpleSheetMetalProcessor: Add CleanupFailedConversion\\(\\) after every\n   EditUndo2\\(2\\) failure point. Suppresses residual FlatPattern features\n   and forces rebuild so parts aren''t left in unfolded/warning state.\n\n3. PurchasedPartHeuristics: Complete redesign with 1.0 threshold system.\n   - Mass < 100g always flags \\(score 1.0\\)\n   - Mass 100-500g is suspect \\(score 0.50, needs another signal\\)\n   - Tiered keywords: Tier 1 \\(1.0\\) for definite purchased \\(bolt, nut,\n     washer, fittings, standards codes, vendor names, thread sizes\\);\n     Tier 2 \\(0.50\\) for suspect \\(insert, spacer, standoff\\)\n   - Compact shape heuristic \\(bbox ratio < 2:1\\)\n   - BBoxMinDimM added to HeuristicInput and MainRunner\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git fetch:*)",
      "Bash(git merge:*)",
      "Bash(\"src\\\\NM.BatchRunner\\\\bin\\\\Debug\\\\NM.BatchRunner.exe\" --qa)",
      "Bash(find:*)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" srcNM.BatchRunnerNM.BatchRunner.csproj /p:Configuration=Debug /v:minimal)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfix: prevent re-flagging of parts already processed via SM/TUBE wizard buttons\n\nParts processed via Sheet Metal or Tube buttons in the problem wizard were\nbeing moved to GoodModels and re-processed in Pass 2, causing the purchased\npart heuristic to fire again. Now marks them as AlreadyProcessed and routes\nto ProcessedModels instead, skipping redundant Pass 2 processing.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(gh pr view:*)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\src\\\\NM.Core.Tests\\\\NM.Core.Tests.csproj\" /p:Configuration=Debug /v:minimal)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\src\\\\NM.BatchRunner\\\\NM.BatchRunner.csproj\" /p:Configuration=Debug /v:minimal)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: add Split â†’ Assy button to problem wizard for multi-body parts\n\nAdd MultiBody category to ProblemCategory enum and wire it through\nBatchValidator, WorkflowDispatcher, and ProblemSuggestionProvider so\nmulti-body parts get their own category instead of GeometryValidation.\n\nAdd \"Split â†’ Assy\" button to ProblemWizardForm that calls\nMultiBodySplitter.SplitToAssembly\\(\\), processes each sub-part through\nMainRunner, and aggregates costs via new AggregateSubPartCosts helper\nin WorkflowDispatcher.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfix: correct static method call and property name in DrawingAnalysisRunner\n\nFix merge issues: FindCompanionPdf is static \\(not instance\\), and\nDrawingData uses Method property \\(not AnalysisMethod\\).\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git commit:*)",
      "Bash(findstr:*)",
      "Bash(gh pr list:*)",
      "Bash(powershell.exe -NoProfile -File - <<'PSEOF'\nAdd-Type -AssemblyName System.Drawing\n$files = Get-ChildItem \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\Icons\\\\ToolbarStrip_*.png\"\nforeach \\($file in $files\\) {\n    $image = [System.Drawing.Image]::FromFile\\($file.FullName\\)\n    Write-Output \"$\\($file.Name\\): $\\($image.Width\\) x $\\($image.Height\\)\"\n    $image.Dispose\\(\\)\n}\nPSEOF)",
      "mcp__plugin_context7_context7__resolve-library-id",
      "mcp__plugin_context7_context7__query-docs",
      "Skill(commit-commands:commit-push-pr)",
      "Bash(git checkout:*)",
      "Bash(Assy\" â†’ verify sub-assembly appears in parent assembly FeatureManager tree\n- [ ] Verify sub-assembly parts positioned correctly in 3D space\n- [ ] Save and reopen assembly â†’ sub-assembly persists\n- [ ] Verify skip button advances progress bar and shows correct remaining count\n- [ ] Verify \"all reviewed\" state appears after reviewing all problems\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)\nEOF\n\\)\")",
      "Bash(gh pr merge:*)",
      "Bash(git pull:*)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" \"src\\\\NM.BatchRunner\\\\NM.BatchRunner.csproj\" /p:Configuration=Debug /v:minimal)",
      "Bash(.srcNM.BatchRunnerbinDebugNM.BatchRunner.exe --qa)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" /t:Restore swcsharpaddin.csproj /v:minimal)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\swcsharpaddin.csproj\" /t:Restore /v:minimal)",
      "Bash(nuget restore:*)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\swcsharpaddin.csproj\" -p:Configuration=Debug -restore -v:minimal -nologo -m)",
      "Bash(del \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\tests\\\\LargeTest\\\\read_xls.ps1\")",
      "Bash(Out-Null)",
      "Bash(\")",
      "Bash(powershell.exe:*)",
      "Bash(git -C \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\" diff src/NM.SwAddin/Pipeline/MainRunner.cs)",
      "Bash(git -C \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\" add src/NM.SwAddin/Pipeline/MainRunner.cs)",
      "Bash(git -C \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\" commit -m \"$\\(cat <<''EOF''\nfix: compute OP20 cost for tube saw operations in Quote report\n\nCalculateTubeCosts set OP20 work center and setup/run hours but never\ncomputed F115_Price, causing all OP20 Cost values to show $0.00 in the\nQuote Excel report. Now applies work center hourly rate to setup + run\nhours using the same \\(setup + run * qty\\) * rate pattern as F325/F140/F210.\n\nRate mapping: F115=$120/hr \\(laser\\), F300=$44/hr \\(material handling/saw\\),\nN145=$175/hr \\(CNC\\), F110=$44/hr \\(bandsaw, uses F300 rate\\).\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\" push)",
      "WebSearch",
      "Bash(wc:*)",
      "WebFetch(domain:www.businesswaretech.com)",
      "WebFetch(domain:werk24.io)",
      "WebFetch(domain:www.colabsoftware.com)",
      "WebFetch(domain:www.nuget.org)",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:www.sungaila.de)",
      "WebFetch(domain:raw.githubusercontent.com)",
      "WebFetch(domain:api.github.com)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" swcsharpaddin.csproj /t:Restore /v:minimal)",
      "Bash(Select-String -Pattern \"FAIL|Assert|Expected|Actual|Error|Stack|at NM\")",
      "Bash(ForEach-Object { $_Line })",
      "Bash(Select-String -Pattern \"\\(Passed|Failed|Total|Skipped|ShouldNot|BomDesc|Error\\)\")",
      "Bash(Select-Object -First 30)",
      "Bash(git stash:*)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" \"C:\\\\Users\\\\tsmith\\\\source\\\\repos\\\\swcsharpaddin\\\\src\\\\NM.BatchRunner\\\\NM.BatchRunner.csproj\" \"/p:Configuration=Debug\" /v:minimal)",
      "WebFetch(domain:help.solidworks.com)",
      "WebFetch(domain:forum.solidworks.com)",
      "WebFetch(domain:www.codestack.net)",
      "WebFetch(domain:xcad.xarial.com)",
      "WebFetch(domain:www.cadoverflow.com)",
      "WebFetch(domain:www.codeproject.com)",
      "WebFetch(domain:groups.google.com)",
      "WebFetch(domain:54.146.66.124)",
      "Bash(gh api:*)",
      "WebFetch(domain:forums.autodesk.com)",
      "Bash(python:*)",
      "WebFetch(domain:www.cadsharp.com)",
      "Bash(start:*)",
      "Skill(commit-commands:commit)",
      "Bash(gh pr create --title \"Add 133 pipeline integration tests + fix material pre-population\" --body \"$\\(cat <<''EOF''\n## Summary\n- **133 new tests** across 8 test classes covering the full material â†’ OptiMaterial â†’ laser â†’ press brake â†’ property write-back chain for all 18 form materials\n- **Fix MaterialCodeMapper** â€” add explicit pass-through entries for 13 materials \\(310, 330, 409, 2205, 2507, C22, C276, AL6XN, ALLOY31, ALNZD, etc.\\) that relied on fragile uppercase fallback\n- **Fix material pre-population** â€” `PrePopulateFromActivePart\\(\\)` now reads custom property \"Material\" first \\(set by pipeline\\), falling back to SW database only if empty\n\n## Test plan\n- [x] `build-and-test.ps1` passes \\(543/543 tests, 0 failures\\)\n- [x] All 133 new pipeline tests pass via `dotnet test --filter`\n- [ ] Manual: open previously-processed part â†’ form should pre-populate correct material\n- [ ] Run `/qa` against gold standard test parts\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)\nEOF\n\\)\")",
      "Bash(Select-String -Pattern \"\\(Passed|Failed|Total|Skipped|Error\\)\")",
      "Bash(Select-Object -First 10)",
      "Bash(\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\MSBuild\\\\Current\\\\Bin\\\\amd64\\\\MSBuild.exe\" src/NM.BatchRunner/NM.BatchRunner.csproj /p:Configuration=Debug /v:minimal)"
    ]
  }
}
